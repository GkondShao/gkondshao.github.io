<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">
































<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.6.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="之前有整理过一版,但是那版记得太琐碎了.刚好上份工作很少用到关系型数据库,这边按照一定的层次结构记下大体的使用方法,以备查阅~">
<meta property="og:type" content="article">
<meta property="og:title" content="sql(基于mysql)速记一">
<meta property="og:url" content="https://blog.evanshao.com/posts/18118/index.html">
<meta property="og:site_name" content="GO!">
<meta property="og:description" content="之前有整理过一版,但是那版记得太琐碎了.刚好上份工作很少用到关系型数据库,这边按照一定的层次结构记下大体的使用方法,以备查阅~">
<meta property="og:updated_time" content="2019-05-22T09:51:20.303Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="sql(基于mysql)速记一">
<meta name="twitter:description" content="之前有整理过一版,但是那版记得太琐碎了.刚好上份工作很少用到关系型数据库,这边按照一定的层次结构记下大体的使用方法,以备查阅~">






  <link rel="canonical" href="https://blog.evanshao.com/posts/18118/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>sql(基于mysql)速记一 | GO!</title>
  












  <noscript>
  <style>
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion .logo-line-before i { left: initial; }
    .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">GO!</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.evanshao.com/posts/18118/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="shaorxcn">
      <meta itemprop="description" content="The more you pay , the more you will gain.">
      <meta itemprop="image" content="/images/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GO!">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">sql(基于mysql)速记一

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-22 14:26:48 / 修改时间：17:51:20" itemprop="dateCreated datePublished" datetime="2019-05-22T14:26:48+08:00">2019-05-22</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          
              <div class="post-description">之前有整理过一版,但是那版记得太琐碎了.刚好上份工作很少用到关系型数据库,这边按照一定的层次结构记下大体的使用方法,以备查阅~</div>
          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="一-概述"><a href="#一-概述" class="headerlink" title="一.概述"></a>一.概述</h1><p>首先这是之前一版极其琐碎的blog的<a href="https://blog.evanshao.com/posts/59908/">链接</a>.然后这篇博客不会涉及存储过程触发器等内容(后续会补充),仅仅按照增删改查这四个点来做基本的介绍以及记录,毕竟工作中很大一部分需要的也是这些内容~</p>
<h1 id="二-素材准备"><a href="#二-素材准备" class="headerlink" title="二.素材准备"></a>二.素材准备</h1><p>为这次的记录建好database以及user.(表结构素材来自mysql必知必会)<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">create</span> <span class="keyword">database</span> notereview;</div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">user</span> review@localhost <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">'xxxxx'</span>;</div><div class="line"></div><div class="line"><span class="keyword">grant</span> all <span class="keyword">on</span> notereview.* <span class="keyword">to</span> review@localhost;</div><div class="line"></div><div class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</div></pre></td></tr></table></figure></p>
<h1 id="三-查询"><a href="#三-查询" class="headerlink" title="三.查询"></a>三.查询</h1><h2 id="基础语句"><a href="#基础语句" class="headerlink" title="基础语句"></a>基础语句</h2><p>查询子语句有一个基本的模板:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">FROM xxx WHERE xxx GROUP BY xxx HAVING xxxx ORDER BY xxx LIMIT xxxxx</div></pre></td></tr></table></figure></p>
<h3 id="WHERE和条件连接"><a href="#WHERE和条件连接" class="headerlink" title="WHERE和条件连接"></a>WHERE和条件连接</h3><p>这里的<code>WHERE</code>就是查询条件,简单的条件过滤比如 =,&lt;&gt;,!=,&lt;,&gt;,&lt;=,&gt;=,BETWEEN,IN,NOT等.</p>
<p>还有就是对于<code>NULL</code>的检查：<code>IS NULL</code>,<code>IS NOT NULL</code></p>
<p>上面是使用单条子语句所可能用到的关键词,如果是多条子语句可以通过<code>AND</code> 或者 <code>OR</code> 连接.其中 <code>AND</code> 的优先级是高于 <code>OR</code>的.也就是说:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> a,b,c <span class="keyword">FROM</span> tableName <span class="keyword">WHERE</span> conditionA <span class="keyword">OR</span> conditionB <span class="keyword">AND</span> conditionC;</div></pre></td></tr></table></figure></p>
<p>相当于是查询同时满足条件B和C,或者满足条件A的数据.举个例子:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">exists</span> products(</div><div class="line">    prod_id varcahr(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span> auto_increment,</div><div class="line">    vend_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,</div><div class="line">    prod_name <span class="built_in">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="literal">null</span>,</div><div class="line">    prod_price <span class="built_in">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">not</span> <span class="literal">null</span>,</div><div class="line">    prod_desc <span class="built_in">text</span> <span class="keyword">not</span> <span class="literal">null</span>,</div><div class="line">    primary <span class="keyword">key</span>(prod_id)</div><div class="line">)<span class="keyword">engine</span> = <span class="keyword">InnoDb</span> <span class="keyword">default</span> <span class="keyword">charset</span>=utf8mb4 <span class="keyword">comment</span> = <span class="string">'产品表'</span>;</div></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> prod_name,vend_id,prod_price <span class="keyword">FROM</span> products  <span class="keyword">WHERE</span> vend_id = <span class="number">1002</span> <span class="keyword">OR</span> vend_id = <span class="number">1003</span> <span class="keyword">AND</span> prod_price &gt;= <span class="number">10</span>;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>prod_name</th>
<th>vend_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>Detonator</td>
<td>1003</td>
<td>13.00</td>
</tr>
<tr>
<td>Bird seed</td>
<td>1003</td>
<td>10.00</td>
</tr>
<tr>
<td>Fuses</td>
<td>1002</td>
<td>3.42</td>
</tr>
<tr>
<td>Oil can</td>
<td>1002</td>
<td>8.99</td>
</tr>
<tr>
<td>Safe</td>
<td>1003</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<p>其中Fuses的价格为3.42不满足大于等于10的要求但是满足了vend_id为1002的要求.</p>
<h3 id="LIMIT-和-ORDER-BY"><a href="#LIMIT-和-ORDER-BY" class="headerlink" title="LIMIT 和 ORDER BY"></a>LIMIT 和 ORDER BY</h3><p>然后是<code>LIMIT</code>以及<code>ORDER BY</code>,基础模板为:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">xxx ORDER BY xxxx [DESC][,xxxx [desc]] LIMIT index[,offset];</div></pre></td></tr></table></figure></p>
<p>也就是说按照一定规则排序后,从index行开始(包含index),返回最多offset行数据,这里需要注意的是index是从0开始计算的,也就是说<code>LIMIT 1,1</code>其实返回的是第二行.</p>
<p>ORDER BY 默认是升序,如果是DESC则是降序,其中可以按照多个字段排序,实际结果是按照排序字段的出现的优先级来确定的,举个例子:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> prod_name,vend_id,prod_price <span class="keyword">FROM</span> products <span class="keyword">where</span> prod_price &gt;<span class="number">10</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>,vend_id <span class="keyword">ASC</span>;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>prod_name</th>
<th>vend_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>JetPack 2000</td>
<td>1005</td>
<td>55.00</td>
</tr>
<tr>
<td>Safe</td>
<td>1003</td>
<td>35.00</td>
</tr>
<tr>
<td>JetPack 1000</td>
<td>1005</td>
<td>35.00</td>
</tr>
<tr>
<td>2 ton anvil</td>
<td>1001</td>
<td>14.99</td>
</tr>
<tr>
<td>Detonator</td>
<td>1003</td>
<td>13.00</td>
</tr>
</tbody>
</table>
<p>这边的结果可以看出虽然 JetPack 1000 的vend_id 也是1005但是排序的第一条件是按照prod_price 降序,所以他不能处在第一位,又因为第二个条件是按照 vend_id 升序,所以他最终处在第三位.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> prod_name,vend_id,prod_price <span class="keyword">FROM</span> products <span class="keyword">where</span> prod_price &gt;<span class="number">10</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price <span class="keyword">DESC</span>,vend_id <span class="keyword">ASC</span> <span class="keyword">limit</span> <span class="number">2</span>,<span class="number">10</span>;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>prod_name</th>
<th>vend_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>JetPack 1000</td>
<td>1005</td>
<td>35.00</td>
</tr>
<tr>
<td>2 ton anvil</td>
<td>1001</td>
<td>14.99</td>
</tr>
<tr>
<td>Detonator</td>
<td>1003</td>
<td>13.00</td>
</tr>
</tbody>
</table>
<p>这里的结果对比上面的可以看出LIMIT 2,10 确实是从第三条开始返回的,如果数据不够则会返回他所能返回的最多的数据.</p>
<h3 id="GROUP-BY-和-HAVING"><a href="#GROUP-BY-和-HAVING" class="headerlink" title="GROUP BY 和 HAVING"></a>GROUP BY 和 HAVING</h3><p>按照上面的顺序,接下来是分组查询<code>GROUP BY</code> 和 <code>HAVING</code>.这两者一般配合使用.<code>HAVING</code> 可以当成是在使用<code>GROUP BY</code>时的<code>WHERE</code>,用来过滤分组后的数据.其中<code>SELECT</code> 后接的表字段(聚合函数除外)必须出现在<code>GROUP BY</code>后.举个例子,查询products表中能够提供多种产品的商户(即产品多余一种)，列出商户id以及所能提供的产品数量并按照产品种类数降序排序列出.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> vend_id,<span class="keyword">count</span>(*) <span class="keyword">AS</span> prods <span class="keyword">from</span> products <span class="keyword">GROUP</span> <span class="keyword">BY</span> vend_id <span class="keyword">HAVING</span> prods &gt; <span class="number">1</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> prods <span class="keyword">DESC</span>;</div></pre></td></tr></table></figure>
<p>结果如下:</p>
<table>
<thead>
<tr>
<th>vend_id</th>
<th>prods</th>
</tr>
</thead>
<tbody>
<tr>
<td>1003</td>
<td>7</td>
</tr>
<tr>
<td>1001</td>
<td>3</td>
</tr>
<tr>
<td>1002</td>
<td>2</td>
</tr>
<tr>
<td>1005</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>这里列出几个常用的聚合函数:</p>
<table>
<thead>
<tr>
<th>聚合函数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>AVG()</td>
<td>返回某列的平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回某列的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回某列的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回某列的最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回某列值之和</td>
</tr>
</tbody>
</table>
<h3 id="like-和正则"><a href="#like-和正则" class="headerlink" title="like 和正则"></a>like 和正则</h3><p>这边 like和正则简单提下,因为效率问题推荐放在搜索条件的最后面</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">WHERE xxxx  like 'xxx'</div><div class="line"></div><div class="line"><span class="keyword">SELECT</span>  prod_id <span class="keyword">FROM</span> products <span class="keyword">WHERE</span> prod_id <span class="keyword">LIKE</span> <span class="string">'JP%'</span>;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>prod_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>JP1000</td>
</tr>
<tr>
<td>JP2000</td>
</tr>
</tbody>
</table>
<p>%表示这里可以出现0,1或多个字符.这条语句相当于查询JP开头的数据(注意NULL不会匹配)</p>
<p>同样也可以通过正则来达到一样的效果:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SELECT  prod_id FROM products WHERE prod_id REGEXP 'JP*';</div><div class="line"></div><div class="line"># 这个则不行，因为binary相当于是大小写敏感匹配</div><div class="line">SELECT  prod_id FROM products WHERE prod_id REGEXP BINARY 'jp*';</div></pre></td></tr></table></figure>
<h2 id="联结查询"><a href="#联结查询" class="headerlink" title="联结查询"></a>联结查询</h2><h3 id="等值联结-内部联结"><a href="#等值联结-内部联结" class="headerlink" title="等值联结/内部联结"></a>等值联结/内部联结</h3><p>这个其实就是我们常用的 INNER JOIN或者多表条件查询</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">#等值联结 </div><div class="line">SELECT a.x,b.x FROM a,b WHERE a.xxx = b.xxx;</div><div class="line">#内联结</div><div class="line">SELECT a.x,b.x FROM a INNER JOIN b ON a.xxx = b.xxx;</div></pre></td></tr></table></figure>
<p>这里相当于是那表a的每一行和表b的每一行去做匹配并留下符合条件的数据</p>
<p>这里有个特殊的比如自联结:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> p1.prod_id,p1.prod_name <span class="keyword">FROM</span> products <span class="keyword">AS</span> p1,products <span class="keyword">AS</span> p2 <span class="keyword">WHERE</span> p1.vend_id = p2.vend_id <span class="keyword">AND</span> p2.prod_id = <span class="string">'DTNTR'</span>;</div></pre></td></tr></table></figure>
<p>这里使用了别名是因为是表products和自己联结防止指代不情.这句sql的结果是挑选DTNTR的商户所能生产的所有商品</p>
<p>结果如下:</p>
<table>
<thead>
<tr>
<th>prod_id</th>
<th>prod_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>DTNTR</td>
<td>Detonator</td>
</tr>
<tr>
<td>FB</td>
<td>Bird seed</td>
</tr>
<tr>
<td>FC</td>
<td>Carrots</td>
</tr>
<tr>
<td>SAFE</td>
<td>Safe</td>
</tr>
<tr>
<td>SLING</td>
<td>Sling</td>
</tr>
<tr>
<td>TNT1</td>
<td>TNT (1 stick)</td>
</tr>
<tr>
<td>TNT2</td>
<td>TNT (5 sticks)</td>
</tr>
</tbody>
</table>
<p>另外的LEFT JOIN,RIGHT JOIN就是所谓的左联结右联结.什么联结就是以那边的数据为准,那边的数据最全,如果右边没有匹配的数据则以NULL的形式展示.</p>
<h3 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h3><p>UNION:其实是相当于将多条SELECT的结果组合。默认是去除重复行的,UNION ALL 则是不去重哒</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># 结果见表1</div><div class="line">SELECT vend_id,prod_id,prod_price FROM products WHERE prod_price &lt;= 5;</div><div class="line"></div><div class="line">#结果见表2</div><div class="line">SELECT vend_id,prod_id,prod_price FROM products WHERE vend_id IN(1001,1002);</div><div class="line"></div><div class="line">#结果见表3</div><div class="line">SELECT vend_id,prod_id,prod_price FROM products WHERE prod_price &lt;= 5 UNION SELECT vend_id,prod_id,prod_price FROM products WHERE vend_id IN(1001,1002);</div><div class="line"></div><div class="line">#结果见表4</div><div class="line">SELECT vend_id,prod_id,prod_price FROM products WHERE prod_price &lt;= 5 UNION  ALL SELECT vend_id,prod_id,prod_price FROM products WHERE vend_id IN(1001,1002);</div></pre></td></tr></table></figure>
<p>表1:</p>
<table>
<thead>
<tr>
<th>vend_id</th>
<th>prod_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>1003</td>
<td>FC</td>
<td>2.50</td>
</tr>
<tr>
<td>1002</td>
<td>FU1</td>
<td>3.42</td>
</tr>
<tr>
<td>1003</td>
<td>SLING</td>
<td>4.49</td>
</tr>
<tr>
<td>1003</td>
<td>TNT1</td>
<td>2.50</td>
</tr>
</tbody>
</table>
<p>表2:</p>
<table>
<thead>
<tr>
<th>vend_id</th>
<th>prod_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>1001</td>
<td>ANV01</td>
<td>5.99</td>
</tr>
<tr>
<td>1001</td>
<td>ANV02</td>
<td>9.99</td>
</tr>
<tr>
<td>1001</td>
<td>ANV03</td>
<td>14.99</td>
</tr>
<tr>
<td>1002</td>
<td>FU1</td>
<td>3.42</td>
</tr>
<tr>
<td>1002</td>
<td>OL1</td>
<td>8.99</td>
</tr>
</tbody>
</table>
<p>表3:</p>
<table>
<thead>
<tr>
<th>vend_id</th>
<th>prod_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>1003</td>
<td>FC</td>
<td>2.50</td>
</tr>
<tr>
<td>1002</td>
<td>FU1</td>
<td>3.42</td>
</tr>
<tr>
<td>1003</td>
<td>SLING</td>
<td>4.49</td>
</tr>
<tr>
<td>1003</td>
<td>TNT1</td>
<td>2.50</td>
</tr>
<tr>
<td>1001</td>
<td>ANV01</td>
<td>5.99</td>
</tr>
<tr>
<td>1001</td>
<td>ANV02</td>
<td>9.99</td>
</tr>
<tr>
<td>1001</td>
<td>ANV03</td>
<td>14.99</td>
</tr>
<tr>
<td>1002</td>
<td>OL1</td>
<td>8.99</td>
</tr>
</tbody>
</table>
<p>表4:</p>
<table>
<thead>
<tr>
<th>vend_id</th>
<th>prod_id</th>
<th>prod_price</th>
</tr>
</thead>
<tbody>
<tr>
<td>1003</td>
<td>FC</td>
<td>2.50</td>
</tr>
<tr>
<td>1002</td>
<td>FU1</td>
<td>3.42</td>
</tr>
<tr>
<td>1003</td>
<td>SLING</td>
<td>4.49</td>
</tr>
<tr>
<td>1003</td>
<td>TNT1</td>
<td>2.50</td>
</tr>
<tr>
<td>1001</td>
<td>ANV01</td>
<td>5.99</td>
</tr>
<tr>
<td>1001</td>
<td>ANV02</td>
<td>9.99</td>
</tr>
<tr>
<td>1001</td>
<td>ANV03</td>
<td>14.99</td>
</tr>
<tr>
<td>1002</td>
<td>FU1</td>
<td>3.42</td>
</tr>
<tr>
<td>1002</td>
<td>OL1</td>
<td>8.99</td>
</tr>
</tbody>
</table>
<p>这里因为是将结果合并,所以查询字段必须一致~</p>
<h1 id="四-插入"><a href="#四-插入" class="headerlink" title="四.插入"></a>四.插入</h1><p>这个则是<code>insert</code>语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> targetName(columnName[,columnName]…) <span class="keyword">values</span>(columnValue[,columnValue])[,(…)];</div></pre></td></tr></table></figure>
<p>这里再提下迁移数据到新表:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">INSERT INTO newTable SELECT * FROM oldTable;</div><div class="line"></div><div class="line">#如果结构不一致的话</div><div class="line"></div><div class="line">INSERT INTO 新表(字段1,字段2,.......) SELECT 字段1,字段2,...... FROM 旧表;</div></pre></td></tr></table></figure></p>
<h1 id="五-删除"><a href="#五-删除" class="headerlink" title="五.删除"></a>五.删除</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tableName <span class="keyword">WHERE</span> xxx = xxx;</div></pre></td></tr></table></figure>
<p>这里记得注意WHERE条件~<br>然后 <code>TRUNCATE TABLE tableName</code> 不过这个需要注意的是他不会激活触发器,并且不会涉及事务,所以效率很高但是注意备份数据,毕竟不能回滚.</p>
<h1 id="六-更新"><a href="#六-更新" class="headerlink" title="六.更新"></a>六.更新</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">UPDATE</span> targetName <span class="keyword">SET</span> columnName = xxx [,columnName2 = xxxx] <span class="keyword">WHERE</span> xxx = xxxx;</div><div class="line"><span class="keyword">UPDATE</span> products <span class="keyword">SET</span> prod_price = <span class="number">35.00</span> <span class="keyword">WHERE</span> prod_id =<span class="string">'SAFE'</span>;</div></pre></td></tr></table></figure>
<p>同样不要忘记WHERE 条件哈~</p>
<h1 id="七-几个练习-from-leetcode-cn"><a href="#七-几个练习-from-leetcode-cn" class="headerlink" title="七.几个练习(from leetcode-cn)"></a>七.几个练习(from leetcode-cn)</h1><h2 id="交换工资-性别"><a href="#交换工资-性别" class="headerlink" title="交换工资(?性别)"></a>交换工资(?性别)</h2><p>给定一个 salary 表，如下所示，有 m = 男性 和 f = 女性 的值。交换所有的 f 和 m 值（例如，将所有 f 值更改为 m，反之亦然）。要求只使用一个更新（Update）语句，并且没有中间的临时表。</p>
<p>注意，您必只能写一个 Update 语句，请不要编写任何 Select 语句。</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>sex</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
<td>m</td>
<td>2500</td>
</tr>
<tr>
<td>2</td>
<td>B</td>
<td>f</td>
<td>1500</td>
</tr>
<tr>
<td>3</td>
<td>C</td>
<td>m</td>
<td>5500</td>
</tr>
<tr>
<td>4</td>
<td>D</td>
<td>f</td>
<td>500</td>
</tr>
</tbody>
</table>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"># 这里使用了 CASE WHEN</div><div class="line">UPDATE salary</div><div class="line">SET</div><div class="line">    sex = CASE sex</div><div class="line">        WHEN 'm' THEN 'f'</div><div class="line">        ELSE 'm'</div><div class="line">    END;</div><div class="line"></div><div class="line"></div><div class="line"># if的话</div><div class="line">UPDATE salary</div><div class="line">SET </div><div class="line"> sex = IF(sex='m','f','m');</div><div class="line"></div><div class="line"># 这里就不涉及代码思路解决了比如字符串变换</div></pre></td></tr></table></figure>
<h2 id="超过经理收入的员工"><a href="#超过经理收入的员工" class="headerlink" title="超过经理收入的员工"></a>超过经理收入的员工</h2><p>Employee 表包含所有员工，他们的经理也属于员工。每个员工都有一个 Id，此外还有一列对应员工的经理的 Id。</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Name</th>
<th>Salary</th>
<th>ManagerId</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Joe</td>
<td>70000</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>Henry</td>
<td>80000</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>Sam</td>
<td>60000</td>
<td>NULL</td>
</tr>
<tr>
<td>4</td>
<td>Max</td>
<td>90000</td>
<td>NULL</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span>  a.Name <span class="keyword">AS</span> Employee   <span class="keyword">FROM</span> Employee <span class="keyword">AS</span> a,Employee <span class="keyword">AS</span> b <span class="keyword">where</span> a.ManagerId = b.Id <span class="keyword">AND</span> a.Salary &gt; b.Salary;</div></pre></td></tr></table></figure>
<h2 id="不订购任何东西的客户"><a href="#不订购任何东西的客户" class="headerlink" title="不订购任何东西的客户"></a>不订购任何东西的客户</h2><p>某网站包含两个表，Customers 表和 Orders 表。编写一个 SQL 查询，找出所有从不订购任何东西的客户。</p>
<p>Customers 表：</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Joe</td>
</tr>
<tr>
<td>2</td>
<td>Henry</td>
</tr>
<tr>
<td>3</td>
<td>Sam</td>
</tr>
<tr>
<td>4</td>
<td>Max</td>
</tr>
</tbody>
</table>
<p>Orders 表：</p>
<table>
<thead>
<tr>
<th>Id</th>
<th>CustomerId</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">Name</span> <span class="keyword">AS</span> Customers <span class="keyword">from</span> Customers  <span class="keyword">where</span> <span class="keyword">Id</span> <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="keyword">select</span> CustomerId <span class="keyword">from</span> Orders);</div></pre></td></tr></table></figure>

      
    </div>

    

    
    
    

    

    
      
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>客官扫码领红包哟~</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alired.png" alt="shaorxcn 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/sql/" rel="tag"># sql</a>
          
            <a href="/tags/mysql/" rel="tag"># mysql</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/posts/6670/" rel="next" title="VirtualBox安装GuestAdditions速记">
                <i class="fa fa-chevron-left"></i> VirtualBox安装GuestAdditions速记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80MTU0NC8xODA5MQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/head.jpg"
                alt="shaorxcn" />
            
              <p class="site-author-name" itemprop="name">shaorxcn</p>
              <p class="site-description motion-element" itemprop="description">The more you pay , the more you will gain.</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">10</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/ShaorxCN" title="GitHub &rarr; https://github.com/ShaorxCN" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一-概述"><span class="nav-number">1.</span> <span class="nav-text">一.概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二-素材准备"><span class="nav-number">2.</span> <span class="nav-text">二.素材准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三-查询"><span class="nav-number">3.</span> <span class="nav-text">三.查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基础语句"><span class="nav-number">3.1.</span> <span class="nav-text">基础语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WHERE和条件连接"><span class="nav-number">3.1.1.</span> <span class="nav-text">WHERE和条件连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LIMIT-和-ORDER-BY"><span class="nav-number">3.1.2.</span> <span class="nav-text">LIMIT 和 ORDER BY</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GROUP-BY-和-HAVING"><span class="nav-number">3.1.3.</span> <span class="nav-text">GROUP BY 和 HAVING</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#like-和正则"><span class="nav-number">3.1.4.</span> <span class="nav-text">like 和正则</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#联结查询"><span class="nav-number">3.2.</span> <span class="nav-text">联结查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#等值联结-内部联结"><span class="nav-number">3.2.1.</span> <span class="nav-text">等值联结/内部联结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#组合查询"><span class="nav-number">3.2.2.</span> <span class="nav-text">组合查询</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四-插入"><span class="nav-number">4.</span> <span class="nav-text">四.插入</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五-删除"><span class="nav-number">5.</span> <span class="nav-text">五.删除</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六-更新"><span class="nav-number">6.</span> <span class="nav-text">六.更新</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七-几个练习-from-leetcode-cn"><span class="nav-number">7.</span> <span class="nav-text">七.几个练习(from leetcode-cn)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#交换工资-性别"><span class="nav-number">7.1.</span> <span class="nav-text">交换工资(?性别)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#超过经理收入的员工"><span class="nav-number">7.2.</span> <span class="nav-text">超过经理收入的员工</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不订购任何东西的客户"><span class="nav-number">7.3.</span> <span class="nav-text">不订购任何东西的客户</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2016 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shaorxcn</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.2.2</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script src="/js/src/utils.js?v=6.6.0"></script>

  <script src="/js/src/motion.js?v=6.6.0"></script>



  
  

  
  <script src="/js/src/scrollspy.js?v=6.6.0"></script>
<script src="/js/src/post-details.js?v=6.6.0"></script>



  


  <script src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  
    <script>
      window.livereOptions = {
        refer: 'posts/18118/'
      };
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  











  





  

  

  

  

  

  
  

  

  

  

  

  

  

</body>
</html>
